---
alwaysApply: false
---
# UBF Event System - Architecture & Development Guide

ì´ ê·œì¹™ì€ Korea UBF WMC Registration System ê°œë°œ ì‹œ í•­ìƒ ì°¸ì¡°í•´ì•¼ í•  ì•„í‚¤í…ì²˜ ë° ê°œë°œ ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸ¯ í•µì‹¬ ì°¸ì¡° ë¬¸ì„œ

### 1. ê°œë°œ ê°€ì´ë“œ
[CLAUDE.md](mdc:CLAUDE.md) - í”„ë¡œì íŠ¸ ì „ì²´ ê°œë°œ ê°€ì´ë“œë¼ì¸ê³¼ ê¸°ìˆ  ìŠ¤íƒ ì •ë³´

### 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
[architecture/SYSTEM_ARCHITECTURE.md](mdc:architecture/SYSTEM_ARCHITECTURE.md) - ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ì„¤ê³„

### 3. ë©€í‹°í…Œë„ŒíŠ¸ ì„¤ê³„
[architecture/MULTI_TENANT_DESIGN.md](mdc:architecture/MULTI_TENANT_DESIGN.md) - ë©€í‹°í…Œë„ŒíŠ¸ ì•„í‚¤í…ì²˜ ìƒì„¸ ì„¤ê³„

## ğŸ—ï¸ ê¸°ìˆ  ìŠ¤íƒ (í•­ìƒ ì¤€ìˆ˜)

```yaml
Frontend:
  Framework: Next.js 14 (App Router)
  Styling: Tailwind CSS + Shadcn/ui
  State: Zustand
  Forms: React Hook Form + Zod
  i18n: next-intl

Backend:
  Runtime: Node.js 20 LTS
  API: Next.js API Routes + tRPC
  Auth: NextAuth.js
  ORM: Prisma
  Validation: Zod

Database:
  Primary: PostgreSQL 15
  Cache: Redis
  Session: Redis Store

Payments:
  Korea: TossPayments or PortOne (ì•„ì„í¬íŠ¸)
  International: Stripe (future)
```

## ğŸ”„ ê°œë°œ ì›ì¹™ (í•­ìƒ ì ìš©)

### 1. íƒ€ì… ì•ˆì „ì„±
- ëª¨ë“  APIëŠ” tRPCë¡œ íƒ€ì… ì•ˆì „í•˜ê²Œ êµ¬í˜„
- Zod ìŠ¤í‚¤ë§ˆë¥¼ í†µí•œ ì…ë ¥ ê²€ì¦
- TypeScript íƒ€ì… ìš°ì„  ê°œë°œ

### 2. ë©€í‹°í…Œë„ŒíŠ¸ ë³´ì•ˆ
- Row Level Security (RLS) ì ìš©
- ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ì— org_id í•„í„°ë§
- JWT í† í°ì— í…Œë„ŒíŠ¸ ì •ë³´ í¬í•¨

### 3. ê²°ì œ ì²˜ë¦¬
- í•œêµ­ ê²°ì œëŠ” TossPayments/PortOne ìš°ì„ 
- ë©±ë“±ì„± í‚¤ ì‚¬ìš© í•„ìˆ˜
- ì›¹í›… ì„œëª… ê²€ì¦
- íŠ¸ëœì­ì…˜ ì²˜ë¦¬

### 4. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
- `npx prisma migrate dev --name <change>` ë¡œì»¬ ê°œë°œ
- `npx prisma migrate deploy` í”„ë¡œë•ì…˜ ë°°í¬
- ì ˆëŒ€ `migrate:fresh` ì‹¤í–‰ ê¸ˆì§€

## ğŸš« ê¸ˆì§€ ì‚¬í•­

- ì§ì ‘ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ ê¸ˆì§€ (Prisma ì‚¬ìš© í•„ìˆ˜)
- ì¹´ë“œë²ˆí˜¸ ë“± ë¯¼ê°ì •ë³´ ì €ì¥ ê¸ˆì§€
- `/app/demo/` ë””ë ‰í† ë¦¬ ì‚­ì œ ê¸ˆì§€
- tRPC ì—†ì´ API ì—”ë“œí¬ì¸íŠ¸ ìƒì„± ê¸ˆì§€

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° ì¤€ìˆ˜

```
church-event/
â”œâ”€â”€ app/[locale]/          # i18n ë¼ìš°íŒ… (ko/en/es)
â”œâ”€â”€ components/ui/         # Shadcn/ui ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ components/events/     # ì´ë²¤íŠ¸ íŠ¹í™” ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ lib/db/               # ë°ì´í„°ë² ì´ìŠ¤ í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ lib/payment/          # ê²°ì œ í†µí•©
â”œâ”€â”€ prisma/               # ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
â””â”€â”€ architecture/         # ì‹œìŠ¤í…œ ì„¤ê³„ ë¬¸ì„œ
```

## ğŸ¨ UI/UX ê°€ì´ë“œë¼ì¸

- Mobile-first ë°˜ì‘í˜• ë””ìì¸
- Shadcn/ui ì»´í¬ë„ŒíŠ¸ ê¸°ë³¸ ì‚¬ìš©
- ë¡œë”© ìƒíƒœ ë° ì—ëŸ¬ ë°”ìš´ë”ë¦¬ êµ¬í˜„
- ì ‘ê·¼ì„±(a11y) ê³ ë ¤

## ğŸ’³ ê²°ì œ í†µí•© í•„ìˆ˜ì‚¬í•­

```typescript
// ë©±ë“±ì„± í‚¤ ì‚¬ìš© ì˜ˆì‹œ
const payment = await tossPayments.createPayment({
  idempotencyKey: `${userId}-${eventId}-${timestamp}`,
  // ...
});

// íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ì˜ˆì‹œ
await prisma.$transaction(async (tx) => {
  const registration = await tx.registration.create(...);
  const payment = await tx.payment.create(...);
  return { registration, payment };
});
```

## ğŸŒ ë‹¤êµ­ì–´ ì§€ì›

- next-intl ì‚¬ìš©
- ë™ì  ë¡œì¼€ì¼ ë¼ìš°íŒ…: `/${locale}/events`
- í•œêµ­ì–´ ìš°ì„  ê°œë°œ

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

- êµ¬ì¡°í™”ëœ ë¡œê¹… (Winston)
- Azure Application Insights
- ê²°ì œ ì‹¤íŒ¨ìœ¨ ëª¨ë‹ˆí„°ë§
- ê°ì‚¬ ë¡œê·¸ ê¸°ë¡

ì´ ê°€ì´ë“œë¥¼ í•­ìƒ ì°¸ì¡°í•˜ì—¬ ì¼ê´€ëœ ê°œë°œì„ ì§„í–‰í•˜ì„¸ìš”.